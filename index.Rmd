---
title: "COVID Health and Race Trends"
author: "Mitch Lueken"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
      toc: TRUE
      toc_float: FALSE
      number_sections: TRUE
---

<style>
  body {
    background-color: #dce6f5;
  }
  
  hr {
    height: 2px;
    background-color: #443236;
  }
  
  table {
    border: 1px solid black;
    border-collapse: collapse;
  }
  
  td {
    border: 1px solid black;
    padding: 4px;
    text-align: left;
  }
  
  th {
    background-color: #4CAF50;
    border: 1px solid black;
    color: white;
    padding: 4px;
    text-align: left;
  }
  
  tr {
    background-color: #f5f5f5;
    nth-child(even) {
      background-color: #f2f2f2;
    }
  }
</style>

```{r setup, include = FALSE}
`Author's Note:` <- function() {
  if(FALSE) {
    print("Those seeking proper commenting and clarity in code should search elsewhere.")
    print(".انا أب غريب, و الكود هو غرابتي")
    print("Jäg har en smörgåsbord av Frankenstenar, og tibbles är min smörgåsar. (Bork Bork Bork)")
    print("Lasciate ogne speranza, voi ch'intrate.")
  }
}

rm(`Author's Note:`)

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include = FALSE) # Hard Pass on all printout gunk

library(tidyverse)
library(kableExtra)
library(HelpersMG)
library(choroplethr)
library(choroplethrMaps)
library(dplyr)
library(ggplot2)
library(readxl)
library(haven)
library(htmltools)
library(pdftools)
library(maps)
library(mapproj)

dir.create("./output")
dir.create("./figures")

# This function commits great crimes against strings and tibbles
# It reads a tibble, brute-forces the tibble into an html file and saves it
# The javascript sorting function behaves alphabetically, rather than numerically
source("./R/makeSortableHTMLTable.R")

# This function does the same, but without the sorting function
# It also removes NAs and replaces them with empty strings
source("./R/makeHTMLTable.R")

# This very helpful pre-made tibble is abused to join all sorts of data together
data("state.regions")
```

```{r download}
# CDC State Race Data
if(!file.exists("./raw_data/Provisional_Death_Counts_for_Coronavirus_Disease__COVID-19___Weekly_State-Specific_Data_Updates.csv")) {
  wget(url = "https://data.cdc.gov/api/views/pj7m-y5uh/rows.csv", destfile = "./raw_data/Provisional_Death_Counts_for_Coronavirus_Disease__COVID-19___Weekly_State-Specific_Data_Updates.csv")
}

# CDC County Race Data
if(!file.exists("./raw_data/Provisional_COVID-19_Death_Counts_by_County_and_Race.csv")) {
  wget(url = "https://data.cdc.gov/api/views/k8wy-p9cg/rows.csv", destfile = "./raw_data/Provisional_COVID-19_Death_Counts_by_County_and_Race.csv")
}

# CDC Race and Age Data
if(!file.exists("./raw_data/Deaths_involving_coronavirus_disease_2019__COVID-19__by_race_and_Hispanic_origin_group_and_age__by_state.csv")) {
  wget(url = "https://data.cdc.gov/api/views/ks3g-spdg/rows.csv", destfile = "./raw_data/Deaths_involving_coronavirus_disease_2019__COVID-19__by_race_and_Hispanic_origin_group_and_age__by_state.csv")
}

# NY Population
if(!file.exists("./raw_data/NY.csv")) {
  wget(url = "https://www.census.gov/quickfacts/fact/csv/NY/PST045219",
     destfile = "./raw_data/NY.csv")
}

# Better Census Data (Race by Age for each state)
if(!file.exists("./raw_data/sc-est2019-alldata6.csv")) {
    wget(url = "https://www2.census.gov/programs-surveys/popest/tables/2010-2019/state/asrh/sc-est2019-alldata6.csv",
         destfile = "./raw_data/sc-est2019-alldata6.csv")
}

# BRFSS
newBRFSS <- FALSE
if(!file.exists("./raw_data/LLCP2018.XPT")) {
  newBRFSS <- TRUE
  wget(url = "https://www.cdc.gov/brfss/annual_data/2018/files/LLCP2018XPT.zip", destfile = "./raw_data/LLCP2018XPT.zip")
  unzip("./raw_data/LLCP2018XPT.zip", exdir = "./raw_data")
  unlink("./raw_data/LLCP2018XPT.zip")
}

# Political Data
if(!file.exists("./raw_data/states_governors.csv")) {
  wget(url = "https://raw.githubusercontent.com/luekenm/COVID-19/master/raw_data/states_governors.csv", destfile = "./raw_data/states_governors.csv")
}

# Metropolitan Statistical Areas
if(!file.exists("./figures/msa.gif")) {
  wget(url = "https://www2.census.gov/geo/maps/metroarea/us_wall/Feb2013/cbsa_us_0213_large.gif", destfile = "./figures/msa.gif", mode = "wb")
}

# Voting Data from 2016 POTUS Election
if(!file.exists("./raw_data/states_votes.xlsx")) {
  download.file(url = "https://www.fec.gov/documents/1890/federalelections2016.xlsx", destfile = "./raw_data/states_votes.xlsx", mode = "wb", quiet = TRUE) }

# Religious Data
if(!file.exists("./raw_data/Dataset - Pew Research Center 2014 Religious Landscape Study National Telephone Survey - Version 1.1 - December 1 2016.sav")) {
  wget(url = "https://www.pewforum.org/wp-content/uploads/sites/7/2016/12/Pew-Research-Center-2014-U.S.-Religious-Landscape-Study.zip", destfile = "./raw_data/Pew-Research-Center-2014-U.S.-Religious-Landscape-Study.zip")
  unzip("./raw_data/Pew-Research-Center-2014-U.S.-Religious-Landscape-Study.zip", exdir = "./raw_data")
  unlink("./raw_data/Pew-Research-Center-2014-U.S.-Religious-Landscape-Study.zip")
  unlink("./raw_data/Codebook - Pew Research Center 2014 Religious Landscape Study National Telephone Survey - Version 1.1 - December 1 2016.pdf")
}

# Whole Foods Data
if(!file.exists("./raw_data/states_whole_foods.csv")) {
  wget(url = "https://raw.githubusercontent.com/luekenm/COVID-19/master/raw_data/states_whole_foods.csv", destfile = "./raw_data/states_whole_foods.csv")
}

# Confederate Monument Data
if(!file.exists("./raw_data/Whose Heritage SF - Symbol Type Count by State.csv")) {
  wget(url = "https://docs.google.com/spreadsheets/d/1W4H2qa2THM1ni53QYZftGob_k_Bf9HreFAtCERfjCIU/export?format=csv&id=1W4H2qa2THM1ni53QYZftGob_k_Bf9HreFAtCERfjCIU&gid=534759525", destfile = "./raw_data/Whose Heritage SF - Symbol Type Count by State.csv")
}

# Census Regions
if(!file.exists("./raw_data/us_regdiv.pdf")) {
  wget(url = "https://www2.census.gov/geo/pdfs/maps-data/maps/reference/us_regdiv.pdf", destfile = "./raw_data/us_regdiv.pdf", mode = "wb")
}
```

```{r tidyNewYorkData}
# This gives the overall proportion of the entire state of NY that is white, something not available in the CDC dataset
ny_pop <- read_csv("./raw_data/NY.csv") %>%
  select(Fact, `New York`) %>%
  filter(Fact == "White alone, not Hispanic or Latino, percent") %>%
  transmute(pop = as.numeric(substr(`New York`, 1, 4)))
```

```{r tidyCOVIDStateData}
# The dataset needs to be trimmed and compacted to be more useful
data <- read_csv("./raw_data/Provisional_Death_Counts_for_Coronavirus_Disease__COVID-19___Weekly_State-Specific_Data_Updates.csv") %>%
  select(State,
         Indicator,
         White = `Non-Hispanic White`,
         Black = `Non-Hispanic Black or African American`,
         Native = `Non-Hispanic American Indian or Alaska Native`,
         Asian = `Non-Hispanic Asian`,
         Hispanic = `Hispanic or Latino`,
         Other = Other) %>%
  filter(State != "United States" &
         Indicator %in% c("Count of COVID-19 deaths",
                          "Distribution of COVID-19 deaths (%)",
                          "Unweighted distribution of population (%)")) %>%
  mutate(White = replace_na(White, 0),
         Black = replace_na(Black, 0),
         Native = replace_na(Native, 0),
         Asian = replace_na(Asian, 0),
         Hispanic = replace_na(Hispanic, 0),
         Other = replace_na(Other, 0)) %>%
  mutate(`Non-White` = Black + Native + Asian + Hispanic + Other) %>% # This collapses the racial variable into a binary state
  select(-c(Black, Native, Asian, Hispanic, Other)) %>%
  pivot_wider(names_from = "Indicator", values_from = c("White", "Non-White")) %>%
  rename(White_Deaths = `White_Count of COVID-19 deaths`,
         `Non-White_Deaths` = `Non-White_Count of COVID-19 deaths`,
         White_Dist = `White_Distribution of COVID-19 deaths (%)`,
         `Non-White_Dist` = `Non-White_Distribution of COVID-19 deaths (%)`,
         White_Pop = `White_Unweighted distribution of population (%)`,
         `Non-White_Pop` = `Non-White_Unweighted distribution of population (%)`)

# NY and NYC are separated, rather than NYC being a subset, so some trickery is required
ny <- filter(data, State == "New York")
nyc <- filter(data, State == "New York City")
ny$White_Pop = ny_pop[[1]]
ny$White_Deaths = ny$White_Deaths + nyc$White_Deaths
ny$`Non-White_Deaths` = ny$`Non-White_Deaths` + nyc$`Non-White_Deaths`
ny$White_Dist = 100.0 * ny$White_Deaths / (ny$White_Deaths + ny$`Non-White_Deaths`)
ny$`Non-White_Dist` = 100 - ny$White_Dist

#NY and NYC removed, replaced with their combination
filter(data, State != "New York" & State != "New York City") %>%
  bind_rows(ny) %>%
  write_csv("./output/cdc_state_covid_race_data.csv")

rm(ny, nyc)
```

```{r tidyCOVIDCountyData}
# The county dataset also needs tidying
read_csv("./raw_data/Provisional_COVID-19_Death_Counts_by_County_and_Race.csv") %>%
  select(fips = `FIPS Code`,
         Indicator,
         Deaths = `COVID-19 Deaths Total`,
         White = `Non-Hispanic White`,
         Black = `Non-Hispanic Black`,
         Native = `Non-Hispanic American Indian or Alaska Native`,
         Asian = `Non-Hispanic Asian`,
         Hispanic,
         Other) %>%
  filter(Indicator %in% c("Distribution of COVID-19 deaths (%)",
                          "Distribution of population (%)")) %>%
  mutate(White = replace_na(White, 0),
         Black = replace_na(Black, 0),
         Native = replace_na(Native, 0),
         Asian = replace_na(Asian, 0),
         Hispanic = replace_na(Hispanic, 0),
         Other = replace_na(Other, 0)) %>%
  mutate(`Non-White` = Black + Native + Asian + Hispanic + Other) %>%
  select(-c(Black, Native, Asian, Hispanic, Other)) %>%
  pivot_wider(names_from = "Indicator", values_from = c("White", "Non-White")) %>%
  rename(White_Dist = `White_Distribution of COVID-19 deaths (%)`,
         `Non-White_Dist` = `Non-White_Distribution of COVID-19 deaths (%)`,
         White_Pop = `White_Distribution of population (%)`,
         `Non-White_Pop` = `Non-White_Distribution of population (%)`) %>%
  write_csv("./output/cdc_county_covid_race_data.csv")
```

```{r tidyCensusAgeRaceData}
# Population breakdown by state by race by age

# Calculate the population by age for non-Hispanic White only
stateAgesWhite <- read_csv("./raw_data/sc-est2019-alldata6.csv") %>%
  filter(SEX == 0 & ORIGIN == 1 & RACE == 1) %>%
  select(DIVISION, NAME, AGE, POPESTIMATE2019)

white0 <- stateAgesWhite %>%
  filter(AGE == 0) %>%
  select(DIVISION, region = NAME, `Under 1 year` = POPESTIMATE2019) %>%
  distinct()

white1_4 <- stateAgesWhite %>%
  filter(AGE > 0 & AGE < 5) %>%
  group_by(NAME) %>%
  summarize(NAME, `1-4 years` = sum(POPESTIMATE2019)) %>%
  rename(region = NAME) %>%
  distinct()

white5_14 <- stateAgesWhite %>%
  filter(AGE > 4 & AGE < 15) %>%
  group_by(NAME) %>%
  summarize(NAME, `5-14 years` = sum(POPESTIMATE2019)) %>%
  rename(region = NAME) %>%
  distinct()

white15_24 <- stateAgesWhite %>%
  filter(AGE > 14 & AGE < 25) %>%
  group_by(NAME) %>%
  summarize(NAME, `15-24 years` = sum(POPESTIMATE2019)) %>%
  rename(region = NAME) %>%
  distinct()

white25_34 <- stateAgesWhite %>%
  filter(AGE > 24 & AGE < 35) %>%
  group_by(NAME) %>%
  summarize(NAME, `25-34 years` = sum(POPESTIMATE2019)) %>%
  rename(region = NAME) %>%
  distinct()

white35_44 <- stateAgesWhite %>%
  filter(AGE > 34 & AGE < 45) %>%
  group_by(NAME) %>%
  summarize(NAME, `35-44 years` = sum(POPESTIMATE2019)) %>%
  rename(region = NAME) %>%
  distinct()

white45_54 <- stateAgesWhite %>%
  filter(AGE > 44 & AGE < 55) %>%
  group_by(NAME) %>%
  summarize(NAME, `45-54 years` = sum(POPESTIMATE2019)) %>%
  rename(region = NAME) %>%
  distinct()

white55_64 <- stateAgesWhite %>%
  filter(AGE > 54 & AGE < 65) %>%
  group_by(NAME) %>%
  summarize(NAME, `55-64 years` = sum(POPESTIMATE2019)) %>%
  rename(region = NAME) %>%
  distinct()

white65_74 <- stateAgesWhite %>%
  filter(AGE > 64 & AGE < 75) %>%
  group_by(NAME) %>%
  summarize(NAME, `65-74 years` = sum(POPESTIMATE2019)) %>%
  rename(region = NAME) %>%
  distinct()

white75_84 <- stateAgesWhite %>%
  filter(AGE > 74 & AGE < 85) %>%
  group_by(NAME) %>%
  summarize(NAME, `75-84 years` = sum(POPESTIMATE2019)) %>%
  rename(region = NAME) %>%
  distinct()

ageRace1 <- left_join(white0, white1_4, by = "region") %>%
  left_join(white5_14, by = "region") %>%
  left_join(white15_24, by = "region") %>%
  left_join(white25_34, by = "region") %>%
  left_join(white35_44, by = "region") %>%
  left_join(white45_54, by = "region") %>%
  left_join(white55_64, by = "region") %>%
  left_join(white65_74, by = "region") %>%
  left_join(white75_84, by = "region")

# Calculate the population by age and race for anyone else
stateAgesNon <- read_csv("./raw_data/sc-est2019-alldata6.csv") %>%
  filter(SEX == 0 & (ORIGIN == 1 | ORIGIN == 2)) %>%
  select(DIVISION, NAME, ORIGIN, RACE, AGE, POPESTIMATE2019)

nonWhite0 <- stateAgesNon %>%
  filter(AGE == 0) %>%
  filter(!(ORIGIN == 1 & RACE == 1)) %>%
  group_by(NAME) %>%
  summarize(DIVISION, NAME, `Under 1 year` = sum(POPESTIMATE2019)) %>%
  distinct() %>%
  rename(region = NAME)

nonWhite1_4 <- stateAgesNon %>%
  filter(AGE > 0 & AGE < 5) %>%
  filter(!(ORIGIN == 1 & RACE == 1)) %>%
  group_by(NAME) %>%
  summarize(NAME, `1-4 years` = sum(POPESTIMATE2019)) %>%
  distinct() %>%
  rename(region = NAME)

nonWhite5_14 <- stateAgesNon %>%
  filter(AGE > 4 & AGE < 15) %>%
  filter(!(ORIGIN == 1 & RACE == 1)) %>%
  group_by(NAME) %>%
  summarize(NAME, `5-14 years` = sum(POPESTIMATE2019)) %>%
  distinct() %>%
  rename(region = NAME)

nonWhite15_24 <- stateAgesNon %>%
  filter(AGE > 14 & AGE < 25) %>%
  filter(!(ORIGIN == 1 & RACE == 1)) %>%
  group_by(NAME) %>%
  summarize(NAME, `15-24 years` = sum(POPESTIMATE2019)) %>%
  distinct() %>%
  rename(region = NAME)

nonWhite25_34 <- stateAgesNon %>%
  filter(AGE > 24 & AGE < 35) %>%
  filter(!(ORIGIN == 1 & RACE == 1)) %>%
  group_by(NAME) %>%
  summarize(NAME, `25-34 years` = sum(POPESTIMATE2019)) %>%
  distinct() %>%
  rename(region = NAME)

nonWhite35_44 <- stateAgesNon %>%
  filter(AGE > 34 & AGE < 45) %>%
  filter(!(ORIGIN == 1 & RACE == 1)) %>%
  group_by(NAME) %>%
  summarize(NAME, `35-44 years` = sum(POPESTIMATE2019)) %>%
  distinct() %>%
  rename(region = NAME)

nonWhite45_54 <- stateAgesNon %>%
  filter(AGE > 44 & AGE < 55) %>%
  filter(!(ORIGIN == 1 & RACE == 1)) %>%
  group_by(NAME) %>%
  summarize(NAME, `45-54 years` = sum(POPESTIMATE2019)) %>%
  distinct() %>%
  rename(region = NAME)

nonWhite55_64 <- stateAgesNon %>%
  filter(AGE > 54 & AGE < 65) %>%
  filter(!(ORIGIN == 1 & RACE == 1)) %>%
  group_by(NAME) %>%
  summarize(NAME, `55-64 years` = sum(POPESTIMATE2019)) %>%
  distinct() %>%
  rename(region = NAME)

nonWhite65_74 <- stateAgesNon %>%
  filter(AGE > 64 & AGE < 75) %>%
  filter(!(ORIGIN == 1 & RACE == 1)) %>%
  group_by(NAME) %>%
  summarize(NAME, `65-74 years` = sum(POPESTIMATE2019)) %>%
  distinct() %>%
  rename(region = NAME)

nonWhite75_84 <- stateAgesNon %>%
  filter(AGE > 74 & AGE < 85) %>%
  filter(!(ORIGIN == 1 & RACE == 1)) %>%
  group_by(NAME) %>%
  summarize(NAME, `75-84 years` = sum(POPESTIMATE2019)) %>%
  distinct() %>%
  rename(region = NAME)

ageRace2 <- left_join(nonWhite0, nonWhite1_4, by = "region") %>%
  left_join(nonWhite5_14, by = "region") %>%
  left_join(nonWhite15_24, by = "region") %>%
  left_join(nonWhite25_34, by = "region") %>%
  left_join(nonWhite35_44, by = "region") %>%
  left_join(nonWhite45_54, by = "region") %>%
  left_join(nonWhite55_64, by = "region") %>%
  left_join(nonWhite65_74, by = "region") %>%
  left_join(nonWhite75_84, by = "region")

# Combine everything
ageRace3 <- ageRace1 %>% pivot_longer(-c(DIVISION, region), names_to = "age", values_to = "Pop_White")
ageRace4 <- ageRace2 %>% pivot_longer(-c(DIVISION, region), names_to = "age", values_to = "Pop_Non-White")

left_join(ageRace3, ageRace4, by = c("DIVISION", "region", "age")) %>%
  mutate(region = tolower(region), `Prop_Non-White` = 100 * `Pop_Non-White` / (Pop_White + `Pop_Non-White`)) %>%
  write_csv("./output/census_state_age_race_data.csv")

rm(white0, white1_4, white5_14, white15_24, white25_34, white35_44, white45_54, white55_64, white65_74, white75_84)
rm(nonWhite0, nonWhite1_4, nonWhite5_14, nonWhite15_24, nonWhite25_34, nonWhite35_44, nonWhite45_54, nonWhite55_64, nonWhite65_74, nonWhite75_84)
rm(ageRace1, ageRace2, ageRace3, ageRace4)
rm(stateAgesWhite, stateAgesNon)
```

```{r tidyCOVIDAgeRaceData}
# Tidying the age and race dataset
data <- read_csv("./raw_data/Deaths_involving_coronavirus_disease_2019__COVID-19__by_race_and_Hispanic_origin_group_and_age__by_state.csv") %>%
  select(region = State, age = `Age group`, race = `Race and Hispanic Origin Group`, deaths = `COVID-19 Deaths`) %>%
  pivot_wider(names_from = race, values_from = deaths) %>%
  rename(White = `Non-Hispanic White`,
         Black = `Non-Hispanic Black`,
         Native = `Non-Hispanic American Indian or Alaska Native`,
         Asian = `Non-Hispanic Asian`,
         Hispanic = `Hispanic or Latino`) %>%
  mutate(White = replace_na(White, 0),
       Black = replace_na(Black, 0),
       Native = replace_na(Native, 0),
       Asian = replace_na(Asian, 0),
       Hispanic = replace_na(Hispanic, 0),
       Unknown = replace_na(Unknown, 0)) %>%
  mutate(`Non-White` = Black + Native + Asian + Hispanic + Unknown) %>%
  select(region, age, White, `Non-White`) %>%
  filter(region != "United States") %>%
  filter(region != "puerto rico") %>%
  mutate(region = tolower(region))

# NY and NYC are AGAIN separated, rather than subsetted
ny <- filter(data, region == "new york")
nyc <- filter(data, region == "new york city")
ny <- ny
ny$White <- ny$White + nyc$White
ny$`Non-White` <- ny$`Non-White` + nyc$`Non-White`

# Calculating the proportion of deaths by race and the ratio of prop_pop to prop_death, and avoiding math problems
filter(data, region != "new york" & region != "new york city") %>%
  bind_rows(ny) %>%
  right_join(read_csv("./output/census_state_age_race_data.csv"), by = c("region", "age")) %>%
  mutate(`Deaths_Non-White` = if_else(`Non-White` == 0 & White == 0,
                                      50.0,
                                      if_else(`Non-White` == 0 & White != 0,
                                              0.0,
                                              if_else(`Non-White` != 0 & White == 0,
                                                      100.0,
                                                      100 * `Non-White` / (`Non-White` + White))))) %>%
  mutate(Ratio = if_else(`Non-White` == 0 & White == 0,
                         1.0,
                         `Deaths_Non-White` / `Prop_Non-White`)) %>%
  mutate(`Census Region` = if_else(DIVISION == 1,
                                   "New England",
                                   if_else(DIVISION == 2,
                                           "Middle Atlantic (NY)",
                                           if_else(DIVISION == 3,
                                                   "East North Central (Midwest)",
                                                   if_else(DIVISION == 4,
                                                           "West North Central (Plains)",
                                                           if_else(DIVISION == 5,
                                                                   "South Atlantic (Carolinas)",
                                                                   if_else(DIVISION == 6,
                                                                           "East South Central (The South)",
                                                                           if_else(DIVISION == 7,
                                                                                   "West South Central (Tex)",
                                                                                   if_else(DIVISION == 8,
                                                                                           "Mountain (The West)",
                                                                                           "Pacific"))))))))) %>%
  # This converts each age bracket into a numerical value centered at it's midpoint
  mutate(ageNum = if_else(age == "Under 1 year",
                          0.5,
                          if_else(age == "1-4 years",
                                  2.5,
                                  if_else(age == "5-14 years",
                                          10,
                                          if_else(age == "15-24 years",
                                                  20,
                                                  if_else(age == "25-34 years",
                                                          30,
                                                          if_else(age == "35-44 years",
                                                                  40,
                                                                  if_else(age == "45-54 years",
                                                                          50,
                                                                          if_else(age == "55-64 years",
                                                                                  60,
                                                                                  if_else(age == "65-74 years",
                                                                                          70,
                                                                                          80)))))))))) %>%
write_csv("./output/cdc_state_covid_age_race_data.csv")

rm(ny, nyc)
```

---

# Introduction

This report is a data analysis investigation into racial disparity in deaths from COVID-19 in the United States, and the effects of certain health and demographic factors.

**NOTE:** Throughout the report the population is separated into two groups, "non-Hispanic White only", and "not Non-Hispanic White only", based on Census categories. For lack of a more feasible racially-sensitive construct, these will be referred to as "White" and "non-White", respectively. Any analyses including Hispanic Whites in White, or not limiting to White only, or using any other racial groupings, could reach different, equally-valid conclusions.

**Reproducibility:** The source code for this report, including links to all of datasets and images used, as well as the methodology (with comments) used to produce all of the figures is available at [https://raw.githubusercontent.com/luekenm/COVID-19/master/index.Rmd](https://raw.githubusercontent.com/luekenm/COVID-19/master/index.Rmd). A more user-friendly repository is available at [https://github.com/luekenm/COVID-19](https://github.com/luekenm/COVID-19).

---

# Hypotheses

1. There is racial disparity in COVID deaths in America

1. Any racial disparity will not be affected by age group

1. The sex and/or party of a State's Governor has an effect on racial disparity in COVID deaths.

1. There are differences in health factors between racial group

1. Some of these health factors contribute to COVID deaths

1. There are differences in measures of population density between racial groups

1. Per capita COVID deaths scale with measures of population density

---

# Racial Data

The data on population and racial breakdowns by states come from the Census. The [Annual State Resident Population Estimates for 6 Race Groups (5 Race Alone Groups and Two or More Races) by Age, Sex, and Hispanic Origin](https://www2.census.gov/programs-surveys/popest/technical-documentation/file-layouts/2010-2019/sc-est2019-alldata6.pdf) document from 2020 gives the estimates as of 2020-07-01, the most recent publicly available figures.

The data on COVID deaths by race, state, and age, come from the [Provisional Death Counts for Coronavirus Disease (COVID-19): Weekly State-Specific Data Updates](https://data.cdc.gov/NCHS/Provisional-Death-Counts-for-Coronavirus-Disease-C/pj7m-y5uh), which is produced by the National Center for Health Statistics division of the CDC, using data from the National Vital Statistics System.

**Data is absent** for Vermont, Montana, Wyoming, Alaska, and Hawaii.

## Maps

```{r choroplethRacePopulation}
# Map of State Non-White Pop Proportion

# This joins the state boundry map coords with the dataset, allowing for mapping in ggplot
states <- read_csv("./output/cdc_state_covid_race_data.csv") %>%
  transmute(region = tolower(State), value = `Non-White_Pop`) %>%
  full_join(map_data("state"), by = "region")

# This plots the states, filling them in based on the Ratio
ggplot(states) +
  geom_polygon(aes(x = long,
                   y = lat,
                   fill = value,
                   group = group),
               color = "black",
               size = 0.25) +
  theme_void() +
  expand_limits(x = states$long, y = states$lat) +
  scale_fill_gradient(name = "Percent\nnon-White",
                      low = "#000000",
                      high = "#18FF16",
                      na.value = "#555555") +
  theme(panel.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks = element_blank(),
        legend.position = "bottom",
        legend.key.width = unit(0.75, "in")) +
  labs(title = "Percent of Population that is non-White",
       x = "",
       y = "") +
  coord_map() +
  ggsave("./figures/choropleth_pop.png", width = 4.6, height = 3.25)
```

![**Figure 1:** Racial Map of the United States](./figures/choropleth_pop.png)

Figure 1 shows the concentration of non-White populations as a percentage of total population. Populations of note include: the Black population in the South and Chicago and Detroit, the large Hispanic population in the Southwest and Florida, and the noticeable populations of immigrants on the Pacific and North Atlantic coasts (and especially near New York City). The rest of the West, Midwest, and New England is noticeably lacking in non-White population except for in major urban areas.

```{r choroplethRaceCOVID}
# Map of State Non-White Distribution of COVID Deaths

# This joins the state boundry map coords with the dataset, allowing for mapping in ggplot
states <- read_csv("./output/cdc_state_covid_race_data.csv") %>%
  transmute(region = tolower(State), value = `Non-White_Dist`) %>%
  full_join(map_data("state"), by = "region")

# This plots the states, filling them in based on the Ratio
ggplot(states) +
  geom_polygon(aes(x = long,
                   y = lat,
                   fill = value,
                   group = group),
               color = "black",
               size = 0.25) +
  theme_void() +
  expand_limits(x = states$long, y = states$lat) +
  scale_fill_gradient(name = "Percent\nDeaths",
                      low = "#000000",
                      high = "#1816FF",
                      na.value = "#555555") +
  theme(panel.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks = element_blank(),
        legend.position = "bottom",
        legend.key.width = unit(0.75, "in")) +
  labs(title = "Percent of COVID Deaths from non-White Population",
       x = "",
       y = "") +
  coord_map() +
  ggsave("./figures/choropleth_deaths.png", width = 4.6, height = 3.25)
```

![**Figure 2:** Non-White COVID Deaths as proportion of total COVID Deaths in the United States](./figures/choropleth_deaths.png)

Figure 2 shows the percentage of COVID deaths in each state that occured within the non-White population. *Ceteris paribus*, this map should be roughly identical to figure 1. To meaningfully quantify the differences between figures 1 and 2, a new measure, the **Racial Disparity Index (RDI)** is introduced. The RDI is the ratio of "proportion of COVID deaths from among the non-White population" to "the proportion of the population that is non-White". If deaths were equally distributed between racial groups, the RDI would be near 1. A value at or near zero indicates deaths occurred almost exclusively among the White population. A value of 2 indicates that twice as many deaths as expected occurred among the non-White population. The RDI is an imperfect *ad hoc* measure, but it can help give a simplified, intuitive sense of the racial disparity in COVID deaths.

```{r mapRatioState}
# A fancier ggplot map

# This joins the state boundry map coords with the dataset, allowing for mapping in ggplot
states <- read_csv("./output/cdc_state_covid_race_data.csv") %>%
  transmute(region = tolower(State), value = `Non-White_Dist` / `Non-White_Pop`) %>%
  full_join(map_data("state"), by = "region")

# This plots the states, filling them in based on the Ratio
ggplot(states) +
  geom_polygon(aes(x = long,
                   y = lat,
                   fill = value,
                   group = group),
               color = "black",
               size = 0.25) +
  theme_void() +
  expand_limits(x = states$long, y = states$lat) +
  scale_fill_gradient2(name = "RDI",
                      low = "blue",
                      mid = "#666666",
                      midpoint = 1.0,
                      high = "red",
                      na.value = "black") +
  theme(panel.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks = element_blank(),
        legend.position = "bottom",
        legend.key.width = unit(0.75, "in")) +
  labs(title = "Ratio of Proportion of COVID Deaths to Proportion of Population",
       subtitle = "Among non-White Population",
       x = "",
       y = "") +
  coord_map() +
  ggsave("./figures/ratio_state.png", width = 7, height = 4.75)
```

![**Figure 3:** A map of the Racial Disparity Index for the United States](./figures/ratio_state.png)

As indicated in Figure 3, the RDI is low in a few states, somewhat elevated in the majority of states, and extremely high in some states.

Those states with the lowest RDIs (West Virginia, Maine, and New Hampshire) are the least diverse states in the nation. They are also among the states with the fewest overall deaths; none has more than a few hundred COVID deaths total. This combination of factors has led them to not experience a single reported non-White COVID death.

Those states with the highest RDIs include New York, Wisconsin, Utah, Michigan, and Missouri (see Table 1 and figure 8).

```{r mapRatioCountyMichigan}
# This is the same idea, but using the limited county-specific data

data <- read_csv("./output/cdc_county_covid_race_data.csv") %>%
  mutate(Ratio = `Non-White_Dist` / `Non-White_Pop`)

# This convoluted code smushes the different naming schema together, and mostly they work okay, if you ignore Virginia
data("county.regions")
mapData <- county.regions %>%
  transmute(fips = region, region = state.name, subregion = county.name) %>%
  filter(region %in% c("michigan", "new york")) %>%
  mutate(subregion = if_else((region == "florida" | region == "mississippi") & (subregion == "desoto"), "de soto",
                if_else((region == "alabama" | region == "georgia" | region == "indiana" | region == "missouri" | region == "tennessee") & (subregion == "dekalb"), "de kalb",
                        if_else(substr(subregion, 1, 4) == "st. ", paste("st ", substring(subregion, 5), sep = ""),
                                if_else(substr(subregion, 1, 5) == "ste. ", paste("ste ", substring(subregion, 6), sep = ""),
                                        if_else((region == "south dakota" & subregion == "oglala lakota"), "shannon",
                                                if_else((region == "north dakota" & subregion == "lamoure"), "la moure",
                                                        if_else((region == "illinois" & subregion == "dupage"), "du page",
                                                                if_else((region == "illinois" & subregion == "lasalle"), "la salle",
                                                                        if_else((region == "texas" & subregion == "dewitt"), "de witt",
                                                                                if_else((region == "iowa" & subregion == "o'brien"), "obrien",
                                                                                        if_else((region == "missouri" & subregion == "city of st. louis"), "st louis city",
                                                                                                subregion)))))))))))) %>%
  inner_join(map_data("county"), by = c("region", "subregion")) %>%
  full_join(data, by = "fips")

ggplot(filter(mapData, region == "michigan"), aes(x = long,
                    y = lat,
                    group = group)) +
  geom_polygon(aes(fill = Ratio), color = NA) +
  theme_void() +
  scale_fill_gradient2(name = "RDI",
                      low = "blue",
                      mid = "#666666",
                      high = "red",
                      midpoint = 1,
                      na.value = "black") +
  theme(panel.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks = element_blank(),
        legend.position = "bottom",
        legend.key.width = unit(0.75, "in")) +
  labs(title = "Ratio of Proportion of COVID Deaths to Proportion of Population",
       subtitle = "Among non-White Population in Michigan",
       x = "",
       y = "") +
  coord_map() +
  ggsave("./figures/ratio_county_mi.png", width = 6.865, height = 8)
```

![**Figure 4**: A Map of the Racial Disparity Index for Michigan](./figures/ratio_county_mi.png)

```{r mapRatioCountyNewYork}
ggplot(filter(mapData, region == "new york"), aes(x = long,
                    y = lat,
                    group = group)) +
  geom_polygon(aes(fill = Ratio), color = NA) +
  theme_void() +
  scale_fill_gradient2(name = "RDI",
                      low = "blue",
                      mid = "#666666",
                      high = "red",
                      midpoint = 1,
                      na.value = "black") +
  theme(panel.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        axis.text.x = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks = element_blank(),
        legend.position = "bottom",
        legend.key.width = unit(0.75, "in")) +
  labs(title = "Ratio of Proportion of COVID Deaths to Proportion of Population",
       subtitle = "Among non-White Population in New York",
       x = "",
       y = "") +
  coord_map() +
  ggsave("./figures/ratio_county_ny.png", width = 6.4, height = 6)
```

![**Figure 5:** A Map of the Racial Disparity Index for New York](./figures/ratio_county_ny.png)

Among those worst states, the RDI seems to be worse in bigger cities like New York City, Detroit, Flint, and Grand Rapids (see figures 4 and 5).

---

## Age Differences

The RDI varies somewhat by age bracket. The RDI for each age bracket was calculated for each Census Region.

```{r censusRegions}
png::writePNG(pdf_render_page("./raw_data/us_regdiv.pdf", page = 1, dpi = 300),"./figures/census_regions.png")
```

![**Figure 6:** Census Regions and Divisions of the United States](./figures/census_regions.png)

Figure 7 shows the differences and trends in age-based RDI for the different Census Regions.

**NOTE:** The figure does not average by state values, but across the entire region, so larger states are more influential.

```{r plotCOVIDAgeRaceCensusRegion}
# Plots Ratio by Census Region
read_csv("./output/cdc_state_covid_age_race_data.csv") %>%
  group_by(`Census Region`, ageNum) %>%
  summarize(ageNum, pop_avg = (sum(`Non-White`) / sum(White + `Non-White`)) / (sum(`Pop_Non-White`) / sum(`Pop_Non-White` + Pop_White))) %>%
  distinct() %>%
  mutate(pop_avg = replace_na(pop_avg, 1.0)) %>%
  ggplot(aes(x = ageNum, color = `Census Region`, fill = `Census Region`)) +
  geom_bar(size = 3, aes(weight = pop_avg), position = position_dodge(width = 5)) +
  labs(title = "Ratio of Proportion of COVID Deaths to Proportion of Population\nfor non-White Population by Age and Census Region",
       x = "Age Bracket Midpoint",
       y = "RDI") +
  theme_linedraw() +
  theme(plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        panel.grid.major.y = element_line(size = 0.4375),
        panel.grid.minor.y = element_line(size = 0.3125),
        panel.grid.major.x = element_line(size = 0.25),
        panel.grid.minor.x = element_line(size = 0.1875),
        panel.background = element_rect(fill = "#DDDDDD"),
        legend.background = element_rect(fill = "#dce6f5", color = "#dce6f5")) +
  ylim(0, 4) +
  ggsave("./figures/rdi_regions.png", width = 9, height = 5)
```

![**Figure 7:** RDI for each Census Region plotted by age bracket midpoint](./figures/rdi_regions.png)

The horizontal line at 1 is because there were no reported COVID deaths at all for that age group, not because of any actual racial parity. For all regions the general trend was a high, relatively stable RDI with a slight decrease toward parity with increasing age.

```{r plotCOVIDStates}
# Plots Ratio by State, grouped by Census Region
data <- read_csv("./output/cdc_state_covid_age_race_data.csv") %>%
  group_by(region, ageNum) %>%
  summarize(`Census Region`, pop_avg = (sum(`Non-White`) / sum(White + `Non-White`)) / (sum(`Pop_Non-White`) / sum(`Pop_Non-White` + Pop_White))) %>%
  mutate(pop_avg = replace_na(pop_avg, 1.0)) %>%
  inner_join(state.regions, by = "region") %>%
  filter(!(pop_avg > 0.9999 & pop_avg < 1.0001))

ggplot(data, aes(x = ageNum, y = pop_avg, fill = region)) +
#  geom_point(size = 5, width = 5) +
  geom_label(label = data$abb, color = "white", size = 2.125, label.r = unit(2, "mm"), show.legend = FALSE, alpha = 0.75) +
  labs(title = "Ratio of Proportion of COVID Deaths to Proportion of Population\nby Age and Census Region",
       subtitle = "Among non-White Population",
       x = "Age",
       y = "RDI") +
  theme_linedraw() +
  theme(plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        panel.grid.major.y = element_line(size = 0.4375),
        panel.grid.minor.y = element_line(size = 0.3125),
        panel.grid.major.x = element_line(size = 0.25),
        panel.grid.minor.x = element_line(size = 0.1875),
        panel.background = element_rect(fill = "#DDDDDD"),
        legend.background = element_rect(fill = "#dce6f5", color = "#dce6f5")) +
  facet_wrap(~ `Census Region`) +
  ggsave("./figures/state_regions.png", height = 10, width = 7)
```

![**Figure 8:** RDI for each Census Region by Age and State](./figures/state_regions.png)

Figure 8 shows the individual contributions of each state, with empty values (no COVID deaths for that state and age recorded in the dataset) removed for clarity.

---

## Political Data

**Table 1:** Sortable State Political Data and RDI by Age Bracket

```{r tableCOVIDAgeState, include = TRUE}
# As a table
read_csv("./raw_data/states_governors.csv") %>%
  left_join(state.regions, by = c("State" = "abb")) %>%
  select(region, Gov_Male, Gov_Rep) %>%
  right_join(read_csv("./output/cdc_state_covid_age_race_data.csv"), by = "region") %>%
  group_by(region, age) %>%
  summarize(Gov_Male, Gov_Rep, pop_avg = (sum(`Non-White`) / sum(White + `Non-White`)) / (sum(`Pop_Non-White`) / sum(`Pop_Non-White` + Pop_White))) %>%
  mutate(pop_avg = replace_na(pop_avg, 1.0)) %>%
  pivot_wider(names_from = age, values_from = pop_avg) %>%
  mutate(`Governor Sex` = if_else(Gov_Male, "Male", "Female"),
         `Governor Party` = if_else(Gov_Rep, "Republican", "Democrat"),
         State = paste(toupper(substring(strsplit(region, " ")[[1]], 1, 1)), substring(strsplit(region, " ")[[1]], 2), sep = "", collapse = " ")) %>%
  mutate(State = if_else(State == "District Of Columbia", "District of Columbia", State)) %>%
  transmute(State,
            `Governor Party`,
            `Governor Sex`,
            `15-24 years` = round(`15-24 years`, 2),
            `25-34 years` = round(`25-34 years`, 2),
            `35-44 years` = round(`35-44 years`, 2),
            `45-54 years` = round(`45-54 years`, 2),
            `55-64 years` = round(`55-64 years`, 2),
            `65-74 years` = round(`65-74 years`, 2),
            `75-84 years` = round(`75-84 years`, 2)) %>%
  ungroup() %>%
  select(-region) %>%
  write_csv("./output/state_data.csv")

# Mutate to string to stop trailing zeroes from being trimmed in html
read_csv("./output/state_data.csv") %>%
  mutate_all(as.character) %>%
  mutate(`15-24 years` = if_else(nchar(`15-24 years`) == 1, paste(`15-24 years`, ".00", sep = ""), `15-24 years`)) %>%
  mutate(`25-34 years` = if_else(nchar(`25-34 years`) == 1, paste(`25-34 years`, ".00", sep = ""), `25-34 years`)) %>%
  mutate(`35-44 years` = if_else(nchar(`35-44 years`) == 1, paste(`35-44 years`, ".00", sep = ""), `35-44 years`)) %>%
  mutate(`45-54 years` = if_else(nchar(`45-54 years`) == 1, paste(`45-54 years`, ".00", sep = ""), `45-54 years`)) %>%
  mutate(`55-64 years` = if_else(nchar(`55-64 years`) == 1, paste(`55-64 years`, ".00", sep = ""), `55-64 years`)) %>%
  mutate(`65-74 years` = if_else(nchar(`65-74 years`) == 1, paste(`65-74 years`, ".00", sep = ""), `65-74 years`)) %>%
  mutate(`75-84 years` = if_else(nchar(`75-84 years`) == 1, paste(`75-84 years`, ".00", sep = ""), `75-84 years`)) %>%
  mutate(`15-24 years` = if_else(nchar(`15-24 years`) == 3, paste(`15-24 years`, "0", sep = ""), `15-24 years`)) %>%
  mutate(`25-34 years` = if_else(nchar(`25-34 years`) == 3, paste(`25-34 years`, "0", sep = ""), `25-34 years`)) %>%
  mutate(`35-44 years` = if_else(nchar(`35-44 years`) == 3, paste(`35-44 years`, "0", sep = ""), `35-44 years`)) %>%
  mutate(`45-54 years` = if_else(nchar(`45-54 years`) == 3, paste(`45-54 years`, "0", sep = ""), `45-54 years`)) %>%
  mutate(`55-64 years` = if_else(nchar(`55-64 years`) == 3, paste(`55-64 years`, "0", sep = ""), `55-64 years`)) %>%
  mutate(`65-74 years` = if_else(nchar(`65-74 years`) == 3, paste(`65-74 years`, "0", sep = ""), `65-74 years`)) %>%
  mutate(`75-84 years` = if_else(nchar(`75-84 years`) == 3, paste(`75-84 years`, "0", sep = ""), `75-84 years`)) %>%
  makeSortableHTMLTable("state_data_table") # Allows each column to be sorted, shoves data into html table file

htmltools::includeHTML("./output/state_data_table.html") # Pastes html table into Rmd
```

Table 1 gives the RDI age breakdowns and Governor information for each state. Figures 9 and 10 show that information plotted by Governor sex and party, respectively. The female-led states with worse RDIs (Michigan, Kansas, Iowa) had higher populations, leading to the increased but not statistically-significant RDI averages (see table 2). For both male-led states and states of either party (regardless of Governor sex), the RDIs were approximately 2 for all ages with reported COVID deaths. As of yet, the party of the Governor appears to make no significant difference (see table 3) in racial disparity in COVID deaths. Whether this is surprising or not is left as an exercise to the reader.

```{r plotCOVIDGovernorSex}
# By Governor Sex
read_csv("./raw_data/states_governors.csv") %>%
  left_join(state.regions, by = c("State" = "abb")) %>%
  select(region, Gov_Male) %>%
  right_join(read_csv("./output/cdc_state_covid_age_race_data.csv"), by = "region") %>%
  group_by(ageNum, Gov_Male) %>%
  summarize(pop_avg = (sum(`Non-White`) / sum(White + `Non-White`)) / (sum(`Pop_Non-White`) / sum(`Pop_Non-White` + Pop_White))) %>%
  mutate(pop_avg = replace_na(pop_avg, 1.0)) %>%
  ggplot(aes(x = ageNum, y = pop_avg, color = Gov_Male)) +
  geom_line(size = 3) +
  labs(title = "Ratio of Proportion of COVID Deaths to Proportion of Population\nby Age and Governor Sex",
       subtitle = "Among non-White Population",
       x = "Age",
       y = "RDI") +
  scale_color_discrete(name = "Governor Sex",
                       labels = c("Female", "Male")) +
  theme_linedraw() +
  theme(plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        panel.grid.major.y = element_line(size = 0.4375),
        panel.grid.minor.y = element_line(size = 0.3125),
        panel.grid.major.x = element_line(size = 0.25),
        panel.grid.minor.x = element_line(size = 0.1875),
        panel.background = element_rect(fill = "#DDDDDD"),
        legend.background = element_rect(fill = "#dce6f5", color = "#dce6f5")) +
  ggsave("./figures/governor_sex.png")
```

![**Figure 9:** RDI of States Plotted by Age and Sex of Governor](./figures/governor_sex.png)

```{r plotCOVIDGovernorParty}
# By Governor Party
read_csv("./raw_data/states_governors.csv") %>%
  left_join(state.regions, by = c("State" = "abb")) %>%
  select(region, Gov_Rep) %>%
  right_join(read_csv("./output/cdc_state_covid_age_race_data.csv"), by = "region") %>%
  group_by(ageNum, Gov_Rep) %>%
  summarize(pop_avg = (sum(`Non-White`) / sum(White + `Non-White`)) / (sum(`Pop_Non-White`) / sum(`Pop_Non-White` + Pop_White))) %>%
  mutate(pop_avg = replace_na(pop_avg, 1.0)) %>%
  ggplot(aes(x = ageNum, y = pop_avg, color = !Gov_Rep)) +
  geom_line(size = 3) +
  labs(title = "Ratio of Proportion of COVID Deaths to Proportion of Population\nby Age and Governor Party",
       subtitle = "Among non-White Population",
       x = "Age",
       y = "RDI") +
  scale_color_discrete(name = "Governor Party",
                       labels = c("Republican", "Democrat")) +
  theme_linedraw() +
  theme(plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        panel.grid.major.y = element_line(size = 0.4375),
        panel.grid.minor.y = element_line(size = 0.3125),
        panel.grid.major.x = element_line(size = 0.25),
        panel.grid.minor.x = element_line(size = 0.1875),
        panel.background = element_rect(fill = "#DDDDDD"),
        legend.background = element_rect(fill = "#dce6f5", color = "#dce6f5")) +
  ggsave("./figures/governor_party.png")
```

![**Figure 10**: RDI of States Plotted by Age and Party of Governor](./figures/governor_party.png)

**Table 2:** Analysis of Variance of Sex of State Governor vs RDI

```{r governorSexANOVA, include = TRUE}
data <- read_csv("./raw_data/states_governors.csv") %>%
  left_join(state.regions, by = c("State" = "abb")) %>%
  select(region, Gov_Male) %>%
  right_join(read_csv("./output/cdc_state_covid_age_race_data.csv"), by = "region") %>%
  group_by(ageNum, Gov_Male) %>%
  summarize(pop_avg = (sum(`Non-White`) / sum(White + `Non-White`)) / (sum(`Pop_Non-White`) / sum(`Pop_Non-White` + Pop_White))) %>%
  mutate(pop_avg = replace_na(pop_avg, 1.0)) %>%
  filter(ageNum >= 20.0) %>%
  rename(`Governor Sex` = Gov_Male)

kable(anova(lm(pop_avg ~ `Governor Sex`, data)))
```

**Table 3:** Analysis of Variance of Party of State Governor vs RDI

```{r governorPartyANOVA, include = TRUE}
data <- read_csv("./raw_data/states_governors.csv") %>%
  left_join(state.regions, by = c("State" = "abb")) %>%
  select(region, Gov_Rep) %>%
  right_join(read_csv("./output/cdc_state_covid_age_race_data.csv"), by = "region") %>%
  group_by(ageNum, Gov_Rep) %>%
  summarize(pop_avg = (sum(`Non-White`) / sum(White + `Non-White`)) / (sum(`Pop_Non-White`) / sum(`Pop_Non-White` + Pop_White))) %>%
  mutate(pop_avg = replace_na(pop_avg, 1.0)) %>%
  filter(ageNum >= 20.0) %>%
  rename(`Governor Party` = Gov_Rep)

kable(anova(lm(pop_avg ~ `Governor Party`, data)))
```

Tables 2 and 3 show that neither the sex nor the party of a state's governor makes a statistically significant contribution to racial disparity in COVID deaths.

---

# Health Data

Using data from the [Behavioral Risk Factor Surveillance System](https://www.cdc.gov/brfss/index.html) (BRFSS), health factors and living conditions affecting the non-White population were analyzed. Figure 11 shows the significant negative correlation between pneumonia vaccination and per capita COVID deaths among the elderly non-White population. The data were similarly negatively-correlated for the elderly White population, but the effect was orders of magnitude weaker (data not shown). The noticeably lower rate of pneumonia vaccination among the non-White population (table 4) is then a potential source of the differential rate of death from COVID, especially among the elderly.

```{r tidyBRFSSData}
# WARNING: This is a LOT of data, and a LOT of writing. You have been warned, Hard Disk users.
if(newBRFSS | !file.exists("./output/BRFSS.csv")) {
  select(state.regions, region, `_STATE` = fips.numeric) %>%
    left_join(read_xpt("./raw_data/LLCP2018.XPT"), by = "_STATE") %>%
    select(weight = `_LLCPWT`, #Statistical Raking Weight
        	 region, # State
        	 race = `_RACEG21`, #1 Non-Hispanic White Onlly, 2 Other, 9 NA
        	 metro = `_METSTAT`, # In metro county; 1 yes, 2 No
        	 urban = MSCODE, # 1/2 in metro or metro county, 3/5 suburban/rural
           rural = `_URBSTAT`, # In Urban or Rural county; 1 Urban, 2 Rural
        	 vax = PNEUVAC4, # Ever had pneumonia vaccine; 1 Yes, 2 No, 7/9 NA
           asthma = ASTHNOW, # Have asthma now; 1 Yes, 2 No, 7/9 NA
           age = `_AGEG5YR` 
    	) %>%
    write_csv("./output/BRFSS.csv")
}
```

**Table 4:** Pneumonia Vaccination by Racial Group

```{r ratePneumoniaVax, include = TRUE}
read_csv("./output/BRFSS.csv") %>%
  mutate(isWhite = if_else(race == 1, TRUE,if_else(race == 2, FALSE, NA))) %>%
  group_by(isWhite) %>%
  filter(!is.na(isWhite) & !is.na(vax)) %>%
  select(isWhite, vax, weight) %>%
  summarize(yes = sum(if_else(vax == 1, weight, 0)),
            no = sum(if_else(vax == 2, weight, 0)),
            prop = yes / (yes + no)) %>%
  transmute(`Racial Group` = if_else(isWhite, "White", "Non-White"),
            `Percent Vaccinated Against Pneumonia` = paste(signif(100 * prop, 4), "%")) %>%
  kable()
```

\

```{r manipulateBRFSSData}
BRFSS <- read_csv("./output/BRFSS.csv") %>%
# Splitting the BRFSS data by age bracket, with some abuse of good statistical practice, but only a little
  mutate(age = if_else(age == 2 | age == 3, "25-34 years",
                       if_else(age == 4 | age == 5, "35-44 years",
                               if_else(age == 6 | age == 7, "45-54 years",
                                       if_else(age == 8 | age == 9, "55-64 years",
                                               if_else(age == 10 | age == 11, "65-74 years",
                                                       if_else(age == 12 | age == 13, "75-84 years",
                                                               "NA")))))),
# Simplifying race variable
         isWhite = if_else(race == 1, TRUE,
                        if_else(race == 2, FALSE,
                                NA))) %>%
  filter(!is.na(isWhite)) %>%
  filter(age != "NA")

# Calculating Proportion of State that is in metro region
met_yes <- group_by(BRFSS, region, age, isWhite) %>%
  filter(metro == 1) %>%
  summarize(metro_yes = sum(weight))
met_no <- group_by(BRFSS, region, age, isWhite) %>%
  filter(metro == 2) %>%
  summarize(metro_no = sum(weight))
prop_met <- left_join(met_yes, met_no, by = c("region", "age", "isWhite")) %>%
  mutate(prop_metro = metro_yes / (metro_yes + metro_no)) %>%
  select(region, age, isWhite, prop_metro)
rm(met_yes, met_no)

# Calculating Proportion of State that is in metro region, excluding suburbs
urb_yes <- group_by(BRFSS, region, age, isWhite) %>%
  filter(urban == 1 | urban == 2) %>%
  summarize(urban_yes = sum(weight))
urb_no <- group_by(BRFSS, region, age, isWhite) %>%
  filter(urban == 3 | urban == 5) %>%
  summarize(urban_no = sum(weight))
prop_urb <- left_join(urb_yes, urb_no, by = c("region", "age", "isWhite")) %>%
  mutate(prop_urban = urban_yes / (urban_yes + urban_no)) %>%
  select(region, age, isWhite, prop_urban)
rm(urb_yes, urb_no)

# Calculation Proportion of State in Rural counties
rur_yes <- group_by(BRFSS, region, age, isWhite) %>%
  filter(rural == 2) %>%
  summarize(rural_yes = sum(weight))
rur_no <- group_by(BRFSS, region, age, isWhite) %>%
  filter(rural == 1) %>%
  summarize(rural_no = sum(weight))
prop_rur <- left_join(rur_yes, rur_no, by = c("region", "age", "isWhite")) %>%
  mutate(prop_rural = rural_yes / (rural_yes + rural_no)) %>%
  select(region, age, isWhite, prop_rural)
rm(rur_yes, rur_no)

# Calculating Proportion of State that has been vaccinated against pneumonia
pneu_yes <- group_by(BRFSS, region, age, isWhite) %>%
  filter(vax == 1) %>%
  summarize(vax_yes = sum(weight))
pneu_no <- group_by(BRFSS, region, age, isWhite) %>%
  filter(vax == 2) %>%
  summarize(vax_no = sum(weight))
prop_pneu <- left_join(pneu_yes, pneu_no, by = c("region", "age", "isWhite")) %>%
  mutate(prop_vax = vax_yes / (vax_yes + vax_no)) %>%
  select(region, age, isWhite, prop_vax)
rm(pneu_yes, pneu_no)

# Calculating Proportion of State that has asthma
as_yes <- group_by(BRFSS, region, age, isWhite) %>%
  filter(asthma == 1) %>%
  summarize(asthma_yes = sum(weight))
as_no <- group_by(BRFSS, region, age, isWhite) %>%
  filter(asthma == 2) %>%
  summarize(asthma_no = sum(weight))
prop_as <- left_join(as_yes, as_no, by = c("region", "age", "isWhite")) %>%
  mutate(prop_asthma = asthma_yes / (asthma_yes + asthma_no)) %>%
  select(region, age, isWhite, prop_asthma)
rm(as_yes, as_no)

read_csv("./output/cdc_state_covid_age_race_data.csv") %>%
  group_by(region, age) %>%
  filter(!(age %in% c("Under 1 year", "1-4 years", "5-14 years", "15-24 years"))) %>%
  transmute(white_deaths_per_100k =100000.0 * (White) / (Pop_White),
            nonwhite_deaths_per_100k =100000.0 * (`Non-White`) / (`Pop_Non-White`)) %>%
  left_join(prop_met, by = c("region", "age")) %>%
  left_join(prop_urb, by = c("region", "age", "isWhite")) %>%
  left_join(prop_rur, by = c("region", "age", "isWhite")) %>%
  left_join(prop_as, by = c("region", "age", "isWhite")) %>%
  left_join(prop_pneu, by = c("region", "age", "isWhite")) %>%
  mutate(deaths_per_100k = if_else(isWhite, white_deaths_per_100k, nonwhite_deaths_per_100k)) %>%
  filter(!is.na(deaths_per_100k)) %>%
  write_csv("./output/state_health.csv") %>%
  transmute(State = paste(toupper(substring(strsplit(region, " ")[[1]], 1, 1)), substring(strsplit(region, " ")[[1]], 2), sep = "", collapse = " "),
            `Age Bracket` = age,
            `Racial Group` = if_else(isWhite, "White", "Not Non-Hispanic White Only"),
            `Deaths per 100,000 Population` = round(deaths_per_100k, 1),
            `Percent Metropolitan` = round(100.0 * prop_metro, 2),
            `Percent Urban` = round(100.0 * prop_urban, 2),
            `Percent Rural` = round(100.0 * prop_rural, 2),
            `Percent Asthma` = round(100.0 * prop_asthma, 2),
            `Percent Pneumonia Vaccine` = round(100.0 * prop_vax, 2)) %>%
  mutate(State = if_else(State == "District Of Columbia", "District of Columbia", State)) %>%
  ungroup() %>%
  select(-region, age) %>%
  write_csv("./output/state_health_trimmed.csv")
  
rm(prop_met, prop_urb, prop_rur, prop_pneu, prop_as, BRFSS)
```

```{r graphVax}
data <- read_csv("./output/state_health.csv") %>%
  filter(age %in% c("65-74 years", "75-84 years") & !isWhite) %>%
  inner_join(state.regions, by = "region")

# These monstrosities perform linear fit statistics on the graph for each age group, and adds ** if they find a significant correlation
old <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_vax, filter(data, age == "65-74 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_vax, filter(data, age == "65-74 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_vax, filter(data, age == "65-74 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_vax, filter(data, age == "65-74 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_vax, filter(data, age == "65-74 years")))$r.squared, 3), sep = "")

older <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_vax, filter(data, age == "75-84 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_vax, filter(data, age == "75-84 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_vax, filter(data, age == "75-84 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_vax, filter(data, age == "75-84 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_vax, filter(data, age == "75-84 years")))$r.squared, 3), sep = "")

# Combining the data with the statistics
data <- mutate(data, lab = if_else(age == "65-74 years", old, older), y = if_else(age == "65-74 years", 300, 1100))

ggplot(data, aes(100 * prop_vax, deaths_per_100k)) +
  geom_point(size = 5.25, color = "black") +
  geom_text(label = data$abb, color = "white", size = 2.125, aes(y = deaths_per_100k + 3)) +
  geom_smooth(method = "lm", se = FALSE, size = 1.125, color = "red") +
  facet_grid(age ~ 42, scales = "free") +
  theme_linedraw() +
  theme(plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        panel.grid.major.y = element_line(size = 0.4375),
        panel.grid.minor.y = element_line(size = 0.3125),
        panel.grid.major.x = element_line(size = 0.25),
        panel.grid.minor.x = element_line(size = 0.1875),
        panel.background = element_rect(fill = "#DDDDDD"),
        legend.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        strip.text.x = element_blank(),
        strip.text.y = element_text(size = 10)) +
  labs(title = "Per Capita COVID Deaths vs Pneumonia Vaccination by State",
       subtitle = "Among Elderly non-White Population",
       x = "Percent Vaccinated against Pneumonia",
       y = "Deaths per 100k Population") +
  geom_label(label = data$lab, aes(85, data$y)) + # This adds the statistics to the plot
  ggsave("./figures/graph_vaccination.png")
```

![**Figure 11:** The correlation between pneumonia vaccination and per capita COVID deaths among the elderly non-White population](./figures/graph_vaccination.png)

While statewide rates of pneumonia vaccination was significantly correlated with per capita COVID deaths, other health variables (see figure 12; many, many others not shown) did not reach statistical significance. While it is possible that this reflects there actual lack of correlation, the more likely explanation is the lack in granularity when examining state-level data. Varying levels of [evidence](https://www.cdc.gov/coronavirus/2019-ncov/need-extra-precautions/evidence-table.html) exist for different conditions. Issues in reporting from different state- and county-level departments of health and coroners, and lack of availability of comorbidity data contribute to the difficulty in determining these correlations. Additionally, [lack of COVID testing and other factors](https://www.cdc.gov/nchs/nvss/vsrr/covid19/excess_deaths.htm) can lead to deaths not being correctly included in COVID counts.

```{r graphAsthma}
data <- read_csv("./output/state_health.csv") %>%
  filter(age %in% c("65-74 years", "75-84 years") & !isWhite) %>%
  inner_join(state.regions, by = "region")

old <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_asthma, filter(data, age == "65-74 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_asthma, filter(data, age == "65-74 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_asthma, filter(data, age == "65-74 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_asthma, filter(data, age == "65-74 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_asthma, filter(data, age == "65-74 years")))$r.squared, 3), sep = "")

older <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_asthma, filter(data, age == "75-84 years")))[[4]][2, 1]/ 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_asthma, filter(data, age == "75-84 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_asthma, filter(data, age == "75-84 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_asthma, filter(data, age == "75-84 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_asthma, filter(data, age == "75-84 years")))$r.squared, 3), sep = "")

data <- mutate(data, lab = if_else(age == "65-74 years", old, older), y = if_else(age == "65-74 years", 450, 1100))

ggplot(data, aes(100 * prop_asthma, deaths_per_100k)) +
  geom_point(size = 5.25, color = "black") +
  geom_text(label = data$abb, color = "white", size = 2.125, aes(y = deaths_per_100k + 3)) +
  geom_smooth(method = "lm", se = FALSE, size = 1.125, color = "red") +
  facet_grid(age ~ 42, scales = "free") +
  theme_linedraw() +
  theme(plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        panel.grid.major.y = element_line(size = 0.4375),
        panel.grid.minor.y = element_line(size = 0.3125),
        panel.grid.major.x = element_line(size = 0.25),
        panel.grid.minor.x = element_line(size = 0.1875),
        panel.background = element_rect(fill = "#DDDDDD"),
        legend.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        strip.text.x = element_blank(),
        strip.text.y = element_text(size = 10)) +
  labs(title = "Per Capita COVID Deaths vs Prevalence of Asthma by State",
       subtitle = "Among Elderly non-White Population",
       x = "Percent with Asthma",
       y = "Deaths per 100k Population") +
  geom_label(label = data$lab, aes(35, data$y)) +
  ggsave("./figures/graph_asthma.png")
```

![**Figure 12:** The insignificant correlation between asthma and per capita COVID deaths among the elderly non-White population](./figures/graph_asthma.png)

---

## Population Density

Using data taken from the BRFSS, the effect of various measures of population density were analyzed. Using the United States Office of Management and Budget definition of Metropolitan Statistical Areas (**MSAs**, figure 13), the correlations between living in metropolitan areas, including (figure 14) or excluding (figure 15) the suburbs, and per capita COVID deaths among the non-White population were determined.

![**Figure 13:** Metropolitan Statistical Areas](./figures/msa.gif)

```{r graphMetro}
data <- read_csv("./output/state_health.csv") %>%
  filter(!isWhite) %>%
  inner_join(state.regions, by = "region")

younger <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "25-34 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "25-34 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "25-34 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "25-34 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "25-34 years")))$r.squared, 3), sep = "")

young <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "35-44 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "35-44 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "35-44 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "35-44 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "35-44 years")))$r.squared, 3), sep = "")

youngish <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "45-54 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "45-54 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "45-54 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "45-54 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "45-54 years")))$r.squared, 3), sep = "")

oldish <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "55-64 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "55-64 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "55-64 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "55-64 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "55-64 years")))$r.squared, 3), sep = "")

old <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "65-74 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "65-74 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "65-74 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "65-74 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "65-74 years")))$r.squared, 3), sep = "")

older <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "75-84 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "75-84 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "75-84 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "75-84 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_metro, filter(data, age == "75-84 years")))$r.squared, 3), sep = "")

data <- mutate(data, lab = if_else(age == "25-34 years", younger,
                                   if_else(age == "35-44 years", young,
                                           if_else(age == "45-54 years", youngish,
                                                   if_else(age == "55-64 years", oldish,
                                                           if_else(age == "65-74 years", old,
                                                                   older))))),
               y = if_else(age == "25-34 years", 5,
                                   if_else(age == "35-44 years", 20,
                                           if_else(age == "45-54 years", 50,
                                                   if_else(age == "55-64 years", 100,
                                                           if_else(age == "65-74 years", 300,
                                                                   750))))))

ggplot(data, aes(100 * prop_metro, deaths_per_100k)) +
  geom_point(size = 5.25, color = "black") +
  geom_text(label = data$abb, color = "white", size = 2.125, aes(y = deaths_per_100k)) +
  geom_smooth(method = "lm", se = FALSE, size = 1.125, color = "red") +
  facet_grid(age ~ 42, scales = "free") +
  theme_linedraw() +
  theme(plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        panel.grid.major.y = element_line(size = 0.4375),
        panel.grid.minor.y = element_line(size = 0.3125),
        panel.grid.major.x = element_line(size = 0.25),
        panel.grid.minor.x = element_line(size = 0.1875),
        panel.background = element_rect(fill = "#DDDDDD"),
        legend.background = element_rect(fill = "#dce6f5", color = "#dce6f5")) +
  labs(title = "Per Capita COVID Deaths vs\nPopulation in Metropolitan Counties by State",
       subtitle = "Among non-White Population",
       x = "Percent living in Metropolitan Counties",
       y = "Deaths per 100k Population") +
  geom_label(label = data$lab, aes(15, data$y)) +
  ggsave("./figures/state_metro.png", height = 14, width = 7)
```

![**Figure 14:** The correlations between living in MSAs and per capita COVID deaths among the non-White population](./figures/state_metro.png)

```{r graphUrban}
data <- read_csv("./output/state_health.csv") %>%
  filter(!isWhite) %>%
  inner_join(state.regions, by = "region")

younger <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "25-34 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "25-34 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "25-34 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "25-34 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "25-34 years")))$r.squared, 3), sep = "")

young <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "35-44 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "35-44 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "35-44 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "35-44 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "35-44 years")))$r.squared, 3), sep = "")

youngish <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "45-54 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "45-54 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "45-54 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "45-54 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "45-54 years")))$r.squared, 3), sep = "")

oldish <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "55-64 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "55-64 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "55-64 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "55-64 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "55-64 years")))$r.squared, 3), sep = "")

old <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "65-74 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "65-74 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "65-74 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "65-74 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "65-74 years")))$r.squared, 3), sep = "")

older <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "75-84 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "75-84 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "75-84 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "75-84 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_urban, filter(data, age == "75-84 years")))$r.squared, 3), sep = "")

data <- mutate(data, lab = if_else(age == "25-34 years", younger,
                                   if_else(age == "35-44 years", young,
                                           if_else(age == "45-54 years", youngish,
                                                   if_else(age == "55-64 years", oldish,
                                                           if_else(age == "65-74 years", old,
                                                                   older))))),
               y = if_else(age == "25-34 years", 5,
                                   if_else(age == "35-44 years", 20,
                                           if_else(age == "45-54 years", 50,
                                                   if_else(age == "55-64 years", 275,
                                                           if_else(age == "65-74 years", 300,
                                                                   750))))))

ggplot(data, aes(100 * prop_urban, deaths_per_100k)) +
  geom_point(size = 5.25, color = "black") +
  geom_text(label = data$abb, color = "white", size = 2.125, aes(y = deaths_per_100k)) +
  geom_smooth(method = "lm", se = FALSE, size = 1.125, color = "red") +
  facet_grid(age ~ 42, scales = "free") +
  theme_linedraw() +
  theme(plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        panel.grid.major.y = element_line(size = 0.4375),
        panel.grid.minor.y = element_line(size = 0.3125),
        panel.grid.major.x = element_line(size = 0.25),
        panel.grid.minor.x = element_line(size = 0.1875),
        panel.background = element_rect(fill = "#DDDDDD"),
        legend.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        strip.text.x = element_blank(),
        strip.text.y = element_text(size = 10)) +
  labs(title = "Per Capita COVID Deaths vs\nPopulation in non-Suburban Metropolitan Counties by State",
       subtitle = "Among non-White Population",
       x = "Percent living in non-Suburban Metropolitan Areas",
       y = "Deaths per 100k Population") +
  geom_label(label = data$lab, aes(15, y)) +
  ggsave("./figures/state_urban.png", height = 14, width = 7)
```

![**Figure 15:** The correlations between living in MSAs (excluding suburbs) and per capita COVID deaths among the non-White population](./figures/state_urban.png)

```{r graphRural}
data <- read_csv("./output/state_health.csv") %>%
  filter(!isWhite) %>%
  inner_join(state.regions, by = "region")

younger <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "25-34 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "25-34 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "25-34 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "25-34 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "25-34 years")))$r.squared, 3), sep = "")

young <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "35-44 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "35-44 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "35-44 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "35-44 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "35-44 years")))$r.squared, 3), sep = "")

youngish <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "45-54 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "45-54 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "45-54 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "45-54 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "45-54 years")))$r.squared, 3), sep = "")

oldish <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "55-64 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "55-64 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "55-64 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "55-64 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "55-64 years")))$r.squared, 3), sep = "")

old <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "65-74 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "65-74 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "65-74 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "65-74 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "65-74 years")))$r.squared, 3), sep = "")

older <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "75-84 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "75-84 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "75-84 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "75-84 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ prop_rural, filter(data, age == "75-84 years")))$r.squared, 3), sep = "")

data <- mutate(data, lab = if_else(age == "25-34 years", younger,
                                   if_else(age == "35-44 years", young,
                                           if_else(age == "45-54 years", youngish,
                                                   if_else(age == "55-64 years", oldish,
                                                           if_else(age == "65-74 years", old,
                                                                   older))))),
               y = if_else(age == "25-34 years", 8,
                                   if_else(age == "35-44 years", 32,
                                           if_else(age == "45-54 years", 75,
                                                   if_else(age == "55-64 years", 200,
                                                           if_else(age == "65-74 years", 400,
                                                                   1000))))))

ggplot(data, aes(100 * prop_rural, deaths_per_100k)) +
  geom_point(size = 5.25, color = "black") +
  geom_text(label = data$abb, color = "white", size = 2.125, aes(y = deaths_per_100k)) +
  geom_smooth(method = "lm", se = FALSE, size = 1.125, color = "red") +
  facet_grid(age ~ 42, scales = "free") +
  theme_linedraw() +
  theme(plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        panel.grid.major.y = element_line(size = 0.4375),
        panel.grid.minor.y = element_line(size = 0.3125),
        panel.grid.major.x = element_line(size = 0.25),
        panel.grid.minor.x = element_line(size = 0.1875),
        panel.background = element_rect(fill = "#DDDDDD"),
        legend.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        strip.text.x = element_blank(),
        strip.text.y = element_text(size = 10)) +
  labs(title = "Per Capita COVID Deaths vs\nPopulation in Rural Counties by State",
       subtitle = "Among non-White Population",
       x = "Percent living in Rural Counties",
       y = "Deaths per 100k Population") +
  geom_label(label = data$lab, aes(64, y)) +
  ggsave("./figures/state_rural.png", height = 14, width = 7)
```

![**Figure 16:** The correlations between living in rural counties and per capita COVID deaths among the non-White population](./figures/state_rural.png)

```{r graphPopDensity}
statePop <- read_csv("./raw_data/sc-est2019-alldata6.csv") %>%
    filter(SEX == 0 & ORIGIN == 0) %>%
    group_by(NAME) %>%
    summarize(pop = sum(POPESTIMATE2019)) %>%
    transmute(region = tolower(NAME), pop)

data <- filter(statePop, region != "district of columbia") %>%
  bind_cols(tibble(state.area)) %>%
  transmute(region, density = pop / state.area) %>%
  inner_join(state.regions, by = "region") %>%
  inner_join(read_csv("./output/state_health.csv") %>% filter(!isWhite))

younger <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "25-34 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ density, filter(data, age == "25-34 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "25-34 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "25-34 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "25-34 years")))$r.squared, 3), sep = "")

young <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "35-44 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ density, filter(data, age == "35-44 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "35-44 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "35-44 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "35-44 years")))$r.squared, 3), sep = "")

youngish <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "45-54 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ density, filter(data, age == "45-54 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "45-54 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "45-54 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "45-54 years")))$r.squared, 3), sep = "")

oldish <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "55-64 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ density, filter(data, age == "55-64 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "55-64 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "55-64 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "55-64 years")))$r.squared, 3), sep = "")

old <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "65-74 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ density, filter(data, age == "65-74 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "65-74 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "65-74 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "65-74 years")))$r.squared, 3), sep = "")

older <- paste("Slope: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "75-84 years")))[[4]][2, 1] / 100.0, 3),
                           "\np: ", if(summary(lm(deaths_per_100k ~ density, filter(data, age == "75-84 years")))[[4]][2, 4] < 0.05) {
                                      paste(signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "75-84 years")))[[4]][2, 4], 3), "**", sep = "")
                                    } else {
                                      signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "75-84 years")))[[4]][2, 4], 3)
                                    },
                           "\nr^2: ", signif(summary(lm(deaths_per_100k ~ density, filter(data, age == "75-84 years")))$r.squared, 3), sep = "")

data <- mutate(data, lab = if_else(age == "25-34 years", younger,
                                   if_else(age == "35-44 years", young,
                                           if_else(age == "45-54 years", youngish,
                                                   if_else(age == "55-64 years", oldish,
                                                           if_else(age == "65-74 years", old,
                                                                   older))))),
               y = if_else(age == "25-34 years", 9,
                                   if_else(age == "35-44 years", 38,
                                           if_else(age == "45-54 years", 92,
                                                   if_else(age == "55-64 years", 262,
                                                           if_else(age == "65-74 years", 625,
                                                                   1234))))))

ggplot(data, aes(density, deaths_per_100k)) +
  geom_point(size = 5.25, color = "black") +
  geom_text(label = data$abb, color = "white", size = 2.125) +
  geom_smooth(method = "lm", se = FALSE, size = 1.125, color = "red") +
  facet_grid(age ~ 42, scales = "free") +
  theme_linedraw() +
  theme(plot.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        plot.margin = unit(c(0, 0, 0, 0), "mm"),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),
        panel.grid.major.y = element_line(size = 0.4375),
        panel.grid.minor.y = element_line(size = 0.3125),
        panel.grid.major.x = element_line(size = 0.25),
        panel.grid.minor.x = element_line(size = 0.1875),
        panel.background = element_rect(fill = "#DDDDDD"),
        legend.background = element_rect(fill = "#dce6f5", color = "#dce6f5"),
        strip.text.x = element_blank(),
        strip.text.y = element_text(size = 10)) +
  labs(title = "Per Capita COVID Deaths vs\nPopulation Density by State",
       subtitle = "Among non-White Population",
       x = "Population Density (People / sq mi)",
       y = "Deaths per 100k Population") +
  geom_label(label = data$lab, aes(505, data$y)) +
  ggsave("./figures/state_density.png", height = 14, width = 7)

rm(younger, young, youngish, oldish, old, older, data)
```

![**Figure 17:** The correlations between population and per capita COVID deaths among the non-White population](./figures/state_density.png)

As shown in figures 14-17, all measures of density were significantly correlated with the severity of COVID pandemic. Statewide measures of the percentage of the population living in metropolitan areas showed strong positive relationships with per capita deaths from COVID among non-White populations of all ages. The expected opposite trend held for the statewide percentage of the population living in rural areas (figure 16). More directly, population density (figure 17) showed the strongest correlation with per capita COVID deaths across all age groups, races, and variables investigated (data not shown). These data are in line with the expectation that human-to-human diseases kill most readily in areas where humans are closer together.

**Table 5:** Metropolitan/Rural Residence by Racial Group

```{r rateMSA, include = TRUE}
read_csv("./output/BRFSS.csv") %>%
  mutate(isWhite = if_else(race == 1, TRUE,if_else(race == 2, FALSE, NA))) %>%
  group_by(isWhite) %>%
  filter(!is.na(isWhite) & !is.na(metro) & !is.na(rural)) %>%
  select(isWhite, metro, rural, weight) %>%
  summarize(yesm = sum(if_else(metro == 1, weight, 0)),
            nom = sum(if_else(metro == 2, weight, 0)),
            propm = yesm / (yesm + nom),
            yesr = sum(if_else(rural == 1, weight, 0)),
            nor = sum(if_else(rural == 2, weight, 0)),
            propr = nor / (yesr + nor)) %>%
  transmute(`Racial Group` = if_else(isWhite, "White", "Non-White"),
            `Percent Living in MSAs` = paste(signif(100 * propm, 4), "%"),
            `Percent Living in Rural Counties` = paste(signif(100 * propr, 3), "%")) %>%
  kable()
```

---

# Conclusions

The analyses revealed widespread, significant racial disparity in COVID deaths. The racial disparity was largely stable across states and age groups. No political factors were found to significantly contribute to racial disparity in COVID deaths. Noteable differences in health and demographic factors were uncovered, including pneumonia vaccination. While some health factors were found to contribute to deaths to COVID, without better reporting of death and comorbidity data, the evidence for the contributions of other health and demographic factors is too sparse for additional meaningful conclusions to be drawn yet. Most conclusively, the increased probability of living in more population-dense conditions among the non-White population (table 5) is likely to contribute seriously to difference in deaths. In short, close proximity to other humans is likely to be the strongest predictor of mortality from COVID, and a major driver of racial disparity in pandemic deaths.

---

# Sources and Links

Special thanks to the following sources of data:

## [The Centers for Disease Control and Prevention](https://www.cdc.gov/)

### [Provisional Death Counts for Coronavirus Disease (COVID-19): Weekly State-Specific Data Updates](https://data.cdc.gov/NCHS/Provisional-Death-Counts-for-Coronavirus-Disease-C/pj7m-y5uh)

### [Daily Updates of Totals by Week and State Provisional Death Counts for Coronavirus Disease 2019 (COVID-19)](https://www.cdc.gov/nchs/nvss/vsrr/covid19/index.htm)
	
### [Behavioral Risk Factor Surveillance System 2018](https://www.cdc.gov/brfss/annual_data/annual_2018.html)

## [The United States Census Bureau](https://www.census.gov/)

### [QuickFacts New York](https://www.census.gov/quickfacts/fact/table/US/PST045219?)

### [Annual State Resident Population Estimates for 6 Race Groups (5 Race Alone Groups and Two or More Races) by Age, Sex, and Hispanic Origin](https://www.census.gov/newsroom/press-kits/2020/population-estimates-detailed.html)
	
### [Census Bureau Statistical Areas Map](https://www.census.gov/geographies/reference-maps/2018/geo/cbsa.html)

### [US Regional Divisions Map](https://www2.census.gov/geo/pdfs/maps-data/maps/reference/us_regdiv.pdf)

## [The Wikimedia Foundation](https://wikimediafoundation.org/)

### [List of United States governors](https://en.wikipedia.org/wiki/List_of_United_States_governors)